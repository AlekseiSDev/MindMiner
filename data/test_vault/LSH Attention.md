---
Связи: 
tags:
  - DL
  - Algo
links:
---
Это [[Attention (DL)]], который опирается на [[LSH - Locality sensetive hashing]]

## Abstract
- Когда мы смотрим вниманием для какого-то слова, наиболее вероятно нам стоит фокусироваться на небольшом наборе слов, а не на всей последовательности
	- Например it явно имеет отношение к существительным
- Ну давайте тогда поделим как-то слова на бакеты (как value в lsh) и будем применять аттеншен только к нужному key
![[Pasted image 20230930203512.png]]![[Pasted image 20230930204033.png]]![[Pasted image 20230930204204.png]]


## Integrate to model
Для начала вы модифицируете модель так, чтобы она выдавала один вектор в каждой позиции, который служит и запросом, и ключом. Это называется вниманием QK и действует так же хорошо, как и обычное внимание. Затем вы сопоставляете каждый вектор с сегментом с помощью LSH, затем сортируете векторы по сегменту LSH и, наконец, обрабатываете внимание только в каждом сегменте. Вы можете делать это по одному блоку за раз, но это не позволит использовать преимущества аппаратного параллелизма. Вместо этого я покажу вам, как выполнять пакетные вычисления. Первым шагом пакетной обработки является разделение отсортированной последовательности на фрагменты фиксированного размера. Это позволяет проводить некоторые параллельные вычисления. Затем вы позволяете каждому фрагменту присутствовать внутри себя и соседних фрагментов. Это относится к случаю с хеш-ведром, который разделен на более чем один фрагмент, как вы видите здесь для синего, желтого и пурпурного корзин. И это основа внимания LSH. И последний момент, который следует учитывать: LSH — это вероятностная, а не детерминированная модель. Это связано с присущей алгоритму LSH случайностью, а это означает, что хэш может меняться вместе с сегментом, в который отображается вектор. Теперь вы понимаете, как ускорить внимание в модели преобразователя с помощью хеширования с учетом локальности. Осталась еще одна проблема при беге на длинных последовательностях, и в следующем видео я покажу вам, как ее решить.
![[Pasted image 20230930204515.png]]![[Pasted image 20230930204537.png]]